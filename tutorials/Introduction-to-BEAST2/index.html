<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8"/>
	<title>Introduction-to-BEAST2/</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!-- RSS feed -->
	<link rel="alternate" type="application/rss+xml" title="Bedford Lab Research" href="http://laduplessis.github.io//feed.xml">
	
    <!-- Customized Bootstrap + Font Awesome + Solarized -->
    <link href="/blotter/css/style.css" rel="stylesheet" media="screen">

	<!-- Favicon -->
	<link rel="shortcut icon" href="/blotter/images/favicon.png"/>	

	<!-- Typekit -->
	<script>
	  (function(d) {
		var config = {
		  kitId: 'xeu8jut',
		  scriptTimeout: 3000
		},
		h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='//use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
	  })(document);
	</script>
		
	<!-- Google Analytics -->	
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-26244371-2', 'laduplessis.github.io/Taming_the_BEAST_blotter');
		ga('send', 'pageview');

	</script>
	
	<!-- jQuery -->
	<script src="/blotter/js/jquery.min.js"></script>
	
	<!-- Bootstrap -->
	<script src="/blotter/js/transition.js"></script>
	<script src="/blotter/js/collapse.js"></script>

</head>

<body>
	
	<div id="header">
	<nav class="navbar navbar-default navbar-static-top" role="navigation">	 
		<div class="container">	

			<div class="navbar-header">
				<!--button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-element" aria-expanded="false">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button-->
									
				<a class="navbar-brand" href="/blotter/">Taming the BEAST</a>
				<object class="logo navbar-brand" data="/blotter/images/logo_bw.svg" type="image/svg+xml"></object>
				
			</div>

			<div class="collapse navbar-collapse" id="navbar-collapse-element">
				<ul class="nav navbar-nav navbar-right">					
					
					<li>
					
					<a href="/blotter/news/">news</a>
					</li>
					
					<li>
					
					<a href="/blotter/tutorials/">tutorials</a></li>	    	  
					
					<li>
					
					<a href="/blotter/about/">about</a></li>	    	  
				</ul>
			</div>
			
		</div>
	</nav>	
</div>
	
	<div class="container">	
		
	

<div class="row">
	<div class="col-md-12">
		<div class="bigtitle titlebox">
			<ol class="breadcrumb">
			
			
				
				
				
				<li>Introduction-to-BEAST2</li>
				
			
			</ol>
		</div>
		<p>
		<div class="head">
			This is a simple introductory tutorial to help you get started with using BEAST2 and its accomplices.
		</div>
	</div>				
</div>

<div class="bigspacer"></div>

<div class="row">
	<div class="col-md-3">
		<div class="bigspacer"></div>
		<div class="smallhead">
			Source code
		</div>	
		<div class="pad-left note">
			<div class="smallspacer"></div>
			<i class="fa fa-cog fa-fw"></i>
			<a class="off" href="https://github.com/laduplessis/Introduction-to-BEAST2">github.com/laduplessis/Introduction-to-BEAST2</a>
		</div>
		<div class="bigspacer"></div>
		<div class="smallhead">
			Contributors
		</div>	
		<div class="pad-left note">
				
			<div class="smallspacer"></div>				
			<div>
				<a class="off" href="https://github.com/laduplessis">
    			<img class="pull-left avatar" src="https://avatars.githubusercontent.com/u/8872277?v=3&s=50">
    			<div class="handlebox" style="padding-left:5px;">
    				laduplessis
    			</div>
 				</a>
 			</div>			
 			
		</div>
		<div class="bigspacer"></div>
		<div class="smallhead">
			Latest commits
		</div>		
		<div class="pad-left smallnote">
			<ul class="list-unstyled">
			
				<div class="smallspacer"></div>
				<li> 
					<i class="fa fa-check-square-o fa-fw"></i>
					<a class="off" href="https://github.com/laduplessis/Introduction-to-BEAST2/commit/84c2abf48e4901ce61d93680d52653af7e6f4127">
					30 Aug 2016 - <span class="text-gray">README</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="fa fa-check-square-o fa-fw"></i>
					<a class="off" href="https://github.com/laduplessis/Introduction-to-BEAST2/commit/d6f8766ba387e8f0dfb6b6e8fa95e3e3fdb4fc99">
					30 Aug 2016 - <span class="text-gray">README</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="fa fa-check-square-o fa-fw"></i>
					<a class="off" href="https://github.com/laduplessis/Introduction-to-BEAST2/commit/ac91325452aad9721e02972645c85ebf2831a726">
					30 Aug 2016 - <span class="text-gray">README</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="fa fa-check-square-o fa-fw"></i>
					<a class="off" href="https://github.com/laduplessis/Introduction-to-BEAST2/commit/588f8aeb3d9d715e8a077b8e27e2fb78dc630463">
					30 Aug 2016 - <span class="text-gray">README</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="fa fa-check-square-o fa-fw"></i>
					<a class="off" href="https://github.com/laduplessis/Introduction-to-BEAST2/commit/172ceb91b267b5e3d0478d10a0c9397c524938fe">
					30 Aug 2016 - <span class="text-gray">README</span>
					</a> 
				</li>
			
			</ul>
		</div>		
		<div class="spacer"></div>	
		
					
			
					
			
					
			
					
			
					
			
					
			
					
			
					
			
					
			
					
			
			<!-- 0 -->
			
					
			
					
			
		
				
		
		
	</div>
	<div class="col-md-8">				
		<div class="post">
			<p>
			<h2>Background</h2>

<p>Before diving into performing complex analyses with the BEAST2 one needs to understand the basic workflow and concepts. While BEAST2 tries to be as user-friendly as possible, the amount of possibilities can be overwhelming.</p>

<p>Therefore, in this simple tutorial you will get acquainted with the basic workflow of BEAST2 and the software most commonly used to interpret the results of the analyses. Bear in mind that this tutorial is designed just to help you get started using BEAST2. We will not discuss all the choices and concepts in detail, as they will be sequentially discussed in further classes and tutorials.</p>

<hr>

<h2>Programs used in this Exercise</h2>

<h3>BEAST2 - Bayesian Evolutionary Analysis Sampling Trees 2</h3>

<p>BEAST2 is a free software package for Bayesian evolutionary analysis of molecular sequences using MCMC and strictly oriented toward inference using rooted, time-measured phylogenetic trees. This tutorial uses the BEAST2 version 2.4.2.</p>

<h3>BEAUti - Bayesian Evolutionary Analysis Utility</h3>

<p>BEAUti is a graphical user interface tool for generating BEAST2 XML configuration files.</p>

<p>Both BEAST2 and BEAUti are Java programs, which means that the exact same code runs on all platforms. For us it simply means that the interface will be exactly the same on all platforms. The screenshots used in this tutorial are taken on a Mac OS X computer; however, both programs will have the same layout and functionality on both Windows and Linux.</p>

<h3>TreeAnnotator</h3>

<p>TreeAnnotator is used to summarize the posterior sample of trees to produce a maximum clade credibility tree. It can also be used to summarise and visualise the posterior estimates of other tree parameters (e.g. node height).</p>

<p>TreeAnnotator is provided as a part of the BEAST2 tool package so you do not need to install it separately.</p>

<h3>DensiTree</h3>

<p>Bayesian analysis using BEAST2 provides an estimate of the uncertainty in tree space. This distribution is represented by a set of trees, which can be rather large and difficult to interpret. DensiTree is a program for qualitative analysis of sets of trees. DensiTree allows to quickly get an impression of properties of the tree set such as well-supported clades, distribution of tree heights and areas of topological uncertainty.</p>

<p>DensiTree is provided as a part of the BEAST2 tool package so you do not need to install it separately.</p>

<h3>Tracer</h3>

<p><a href="http://tree.bio.ed.ac.uk/software/tracer">Tracer</a> is used to summarise the posterior estimates of the various parameters sampled by the Markov chain. This program can be used for visual inspection and assessment of convergence. It helps to quickly view median estimates 95% highest posterior density intervals of the parameters, and calculates the effective sample sizes (ESS) of parameters. It also helps to visualise potential parameter correlations.</p>

<h3>FigTree</h3>

<p><a href="http://tree.bio.ed.ac.uk/software/figtree">FigTree</a> is a program for viewing trees and producing publication-quality figures. It can interpret the node-annotations created on the summary trees by TreeAnnotator, allowing the user to display node-based statistics (e.g. posterior probabilities).</p>

<p><br></p>

<hr>

<p><br></p>

<h2>Practical: Running a simple analysis with BEAST2</h2>

<p>This tutorial will guide you through the analysis of an alignment of sequences sampled from twelve primate species. The aim of this tutorial is to co-estimate the following:</p>

<ol>
<li>The gene phylogeny;</li>
<li>The rate of evolution on each lineage based on divergence times of their host species.</li>
</ol>

<p>More generally, this tutorial aims to introduce new users to a basic workflow and point out the steps towards performing a full analysis of sequencing data within Bayesian framework.</p>

<h3>Creating analysis configuration</h3>

<p>To run analyses with BEAST, one needs to prepare a configuration file in XML format that contains all the input information and setup of initial values and priors. Even though it is possible to create such files by hand from scratch, it can be complicated and not exactly straightforward. BEAUti is designed to aid you in producing a valid setup file for BEAST. If necessary that file can later be edited by hand, but it is recommended to use BEAUti for generating the files at least for the initial round of analysis.</p>

<blockquote>
<p>Begin by starting up BEAUti.</p>
</blockquote>

<h3>Loading the data</h3>

<p>In the folder with the extracted tutorial materials you should see the <code>Data</code> folder containing a single NEXUS file. This file contains sequences and meta-information on the twelve primate mitochondrial genomes which we will be analysing.</p>

<p>To give BEAST2 access to the data, one has to add the alignment to the configuration file. To do this, open BEAUti and either drag and drop the Nexus file into the open BEAUti window (it should be on <code>Partitions</code> tab), or use <code>File &gt; Import Alignment</code> and then locate and click the alignment file.</p>

<blockquote>
<p>Import the alignment into BEAUti by either dragging and dropping the <code>*.nex</code> file into the BEAUti window open on the Partitions tab, or use <code>File &gt; Import Alignment</code> and then locate and click the alignment file.</p>
</blockquote>

<p>Once you have done that, the data should appear in the BEAUti window which should look as shown in the <a href="figure">:fig-data</a> below.</p>

<figure>
    <img src="figures/data.png" alt="">
    <figcaption>Data imported into BEAUti.</figcaption>
    <a id="fig-data"/></a>
</figure>

		</div>
	</div>			
	<div class="col-md-1"></div>
</div>


	
	</div>
	
	<div id="footer"><span style="display:none">foo</span></div>
		
</body>
</html>

